---
layout: post
title: "[原创]-windows-下安装布隆过滤器"
date: 2017-03-20 14:48:21
image: '/assets/img/'
description: ""
tags:
    - python
    - boomfilter
categories:
    - python
---



<div id="sina_keyword_ad_area2" class="articalContent newfont_family"><span style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);">找了几个第三方布隆过滤器</span><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);">https://github.com/axiak/pybloomfiltermmap 可以使用easy_install/pip 安装</div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);">https://github.com/jaybaird/python-bloomfilter</div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);">还有pybloomfilter、pybloom</div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);">但是都不能使！！！破windows..................</div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);">要么是make不好使、要么是 <strong>unable to find vcvarsall.bat</strong></div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);"><br /></div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);">一、先解决 <span style="line-height:1.5;"><span style="color:#FF0000;line-height:21px;">unable to find vcvarsall.bat</span></span></div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);"><br /></div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);">打开CMD，<strong>echo %VS100COMNTOOLS%</strong>，获取到vs2010的地址，（2012是<span style="line-height:21px;">%VS110COMNTOOLS%，13是120</span>）</div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);">地址大致是：<strong>G:\Program Files\Microsoft Visual Studio 10.0\Common7\Tools\</strong></div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);"><br /></div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);">打开 C:\Python27\Lib\distutils\msvc9compiler.py </div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);">找到 函数 def find_vcvarsall(version): </div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);">直接<strong>return os.path.join("<span style="color:#FF0000;line-height:21px;">G:\\Program Files\\Microsoft Visual Studio 10.0\\VC</span>", "vcvarsall.bat")</strong><span style="line-height:1.5;">#注意此处跟vs2010地址的区别.</span></div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);"><span style="line-height:1.5;"><br /></span></div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);"><span style="line-height:1.5;">如此，就解决了</span><span style="line-height:21px;"> </span><span style="line-height:1.5;"><span style="color:#FF0000;line-height:21px;">unable to find vcvarsall.bat</span></span> <span style="line-height:1.5;">的问题</span></div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);"><span style="line-height:1.5;"><br /></span></div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);"><span style="line-height:1.5;">二、各种尝试easy_install/pip </span><span style="line-height:21px;">pybloomfiltermmap </span>后发现cl.exe mt.exe等等错误</div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);">三、下载<span style="line-height:21px;">pybloomfiltermmap源码试试，python setup.py install，</span>\VC\BIN\cl.exe 报错</div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);"><span style="line-height:1.5;">三、easy_install </span><span style="line-height:21px;">pybloomfilter 会安装成功，但是需要安装C语言依赖，[</span>https://github.com/fragglet/c-algorithms/releases<span style="line-height:21px;">] 各种Make error.....</span></div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);"><span style="line-height:21px;">四、最后尝试了 </span><span style="line-height:21px;">easy_install </span><span style="line-height:21px;">pybloom，错误：</span><strong><span style="color:#FF0000;line-height:21px;">general error c1010070: Failed to load and parse the manifest. error: Setup script exited with error: command 'mt.exe' failed with exit status 31 </span></strong></div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);">五、<span style="color:#08FF0E;line-height:21px;"><strong>pip install pybloom</strong></span> 错误：<strong><span style="color:#FF0000;line-height:21px;">error: command 'mt.exe' failed with exit status 31</span></strong></div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);">六、虽然报错了，但是还是侥幸打开 python，import了一下pybloom，错误：<strong><span style="color:#FF0000;line-height:21px;">ImportError: pybloom requires bitarray &gt;= 0.3.4，</span></strong>貌似可行，import error 是好事.......</div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);">七、<strong><span style="color:#00FF4D;line-height:21px;">pip install bitarray</span></strong></div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);">八、</div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);">&gt;&gt;&gt; import pybloom</div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);">&gt;&gt;&gt; pybloom</div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);"><div>&gt;&gt;&gt; pybloom.BloomFilter(10000, 0.1)</div><div>&gt;&gt;&gt; pf = pybloom.BloomFilter(10000, 0.1)</div></div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);"><div>&gt;&gt;&gt; dir(pf)</div><div>['FILE_FMT', '__and__', '__class__', '__contains__', '__delattr__', '__dict__', '__doc__', '__format__','__getattribute__', '__getstate__', '__hash__', '__init__', '__len__', '__module__', '__new__','__or__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__setstate__', '__sizeof__', '__str__','__subclasshook__', '__weakref__', '_setup', 'add', 'bitarray', 'bits_per_slice', 'capacity', 'copy', 'count', 'error_rate','fromfile','intersection', 'make_hashes', 'num_bits', 'num_slices', 'tofile', 'union']</div></div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);"><div>&gt;&gt;&gt; pf.count</div><div>0</div></div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);"><div>&gt;&gt;&gt; pf.add(1)</div><div>False</div><div>&gt;&gt;&gt; pf.add(1)</div><div>True</div><div>&gt;&gt;&gt; pf.add(1)</div><div>True</div><div>&gt;&gt;&gt; pf.add(1)</div><div>True</div></div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);"><div>&gt;&gt;&gt; pf.count</div><div>1</div></div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);"><br /></div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);">综上，<strong>正确的步骤是：一、七、<span style="color:#00FF44;line-height:21px;">六</span></strong>。 （一可以暂时不改，七也可以先不用安装，如果提示版本小再安装也可以。）</div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);">===============</div><div style="color:rgb(192,189,187);font-family:'Microsoft YaHei', 'Helvetica Neue', SimSun;font-size:14px;text-align:left;background-color:rgb(0,0,0);">当然，不一定非要用这几个库，只是这几个库相对来说性能会好点。也有一些别人写好的代码，但是因为我在运行中出了点问题，初步定位到是布隆过滤器的原因，所以才另外找的。</div><div></div></div>